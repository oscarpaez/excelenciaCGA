<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<ui:composition template="/templates/modeloGeneral2.xhtml">

	<ui:define name="contenido">

		<f:metadata>
			<f:event listener="#{ofertaPedidoBean.alistarPedidosLlamadas()}"
				type="preRenderView" />
		</f:metadata>
		
		<p:panel  
				styleClass="oficina">
			
				<f:facet name="header">			
					<p:outputLabel value="Gestion Ofertas y Pedidos  #{ofertaPedidoBean.nombreCiu}" />					
					
				</f:facet>

		<div class="ui-grid ui-grid-responsive">
			<div class="ui-grid-row">
				<div class="ui-grid-col-4" style="width: 350px">
					<p:panel style="width:340px;" styleClass="promedio">
						<h:form>
							<h:panelGrid columns="2">
								<p:outputLabel value="Total Pedidos" style="font-size: 14px; " />
								<p:inputText size="15"
									style="color:#0000ff; opacity: .90; text-align: right"
									value="#{ofertaPedidoBean.valorTotalP}" disabled="true">
									<f:convertNumber pattern="#,##0;" />
								</p:inputText>

								<p:outputLabel value="Total Ofertas" style="font-size: 14px; " />
								<p:inputText size="15"
									style="color:#0000ff; opacity: .90; text-align: right"
									value="#{ofertaPedidoBean.valorTotal}" disabled="true">
									<f:convertNumber pattern="#,##0;" />
								</p:inputText>

							</h:panelGrid>
						</h:form>
						
						<p:chart type="metergauge" 	model="#{ofertaPedidoBean.meterGaugeModel}"
								style="width:330px;height:300px" />	
					</p:panel>
				</div>


				<div class="ui-grid-col-8" style="padding-left: 10px; width:75%">
					<h:form id="frmInc">

						<p:poll interval="30" update=" :frmInc:tblPlan" 
							listener="#{ofertaPedidoBean.cambioPagina1()}"/>

						<p:dataTable styleClass="tblPla" id="tblPlan"
							emptyMessage="No se encontraron registros"
							value="#{ofertaPedidoBean.listaOfertaPedidos}" var="oferta"
							filteredValue="#{ofertaPedidoBean.listaFiltrarOfePed}">

							<f:facet name="header">
								<p:outputLabel
									value="Lista de Oferta Pedidos  #{ofertaPedidoBean.fechaConsulta}" />
							</f:facet>

							<p:columnGroup type="header">
								<p:row>
									<p:column  rowspan="2" colspan="1" headerText="Cod SAP" width="5%"
										filterBy="#{oferta.cliente}" filterMatchMode="contains" filterStyle="width: 90%" />
									<p:column rowspan="2" colspan="1" headerText="Nombre" width="" />
									<p:column rowspan="2" colspan="1" headerText="Total Oferta" width="12%" />
									<p:column rowspan="2" colspan="1" headerText="Total Pedido " width="12%"
										filterBy="" filterMatchMode="contains" />
									<p:column rowspan="2" colspan="2" headerText="Cumplimiento %" width="12%" />
									<p:column rowspan="2" colspan="1" headerText="Presupuesto" width="12%" />
									<p:column rowspan="2" colspan="1" headerText="Total Facturado" width="12%"
										filterBy="" filterMatchMode="contains" />
									<p:column rowspan="2" colspan="2" headerText="Cumplimiento %" width="12%" />	
							<!--		<p:column colspan="3" headerText="LLamadas" width="" />									
								</p:row>
									<p:column colspan="1" headerText="Entrantes" width="" />
									<p:column colspan="1" headerText="Salientes" width="" />
									<p:column colspan="1" headerText="No contestadas" width="" />
								<p:row> -->
								
								</p:row>
							</p:columnGroup>

							<p:column>
								<h:outputText value="#{oferta.codEspecialista}" />
							</p:column>

							<p:column>
								<h:outputText value="#{oferta.especialista}" />
							</p:column>

							<p:column style="text-align: right">
								<h:outputText value="#{oferta.valorOferta}">
									<f:convertNumber locale="en_US" maxFractionDigits="0" />
								</h:outputText>
							</p:column>

							<p:column style="text-align: right">
								<h:outputText value="#{oferta.valorPedido}">
									<f:convertNumber locale="en_US" maxFractionDigits="0" />
								</h:outputText>
							</p:column>

							<p:column>
								<h:outputText value="#{oferta.porcentaje}">
									<f:convertNumber locale="en_US" maxFractionDigits="2" />
								</h:outputText>
							</p:column>

							<p:column style="text-align: center;">
								<p:graphicImage library="images" name="#{oferta.imagen}"
									height="25" width="25" />
							</p:column>

							<!-- 	<p:column headerText="Detalle" style="text-align:center; width:6%">
						<p:button icon="ui-icon-search"
							outcome="/pages/dr/detalleOfertaPedidos.xhtml?faces-redirect=true"
							onclick="showLoading()">
						    <f:param name="frst" value="#{oferta.codEspecialista}"/>
							<f:param name="nomIn" value="#{oferta.especialista}"/>
						</p:button>
					</p:column>
			-->
							<p:column style="text-align: right">
								<h:outputText value="#{oferta.presupuesto}">
									<f:convertNumber locale="en_US" maxFractionDigits="0" />
								</h:outputText>
							</p:column>

							<p:column style="text-align: right">
								<h:outputText value="#{oferta.valorNeto}">
									<f:convertNumber locale="en_US" maxFractionDigits="0" />
								</h:outputText>
							</p:column>
							
							<p:column>
								<h:outputText value="#{oferta.porcentajeV}">
									<f:convertNumber locale="en_US" maxFractionDigits="2" />
								</h:outputText>
							</p:column>

							<p:column style="text-align: center;">
								<p:graphicImage library="images" name="#{oferta.imagenA}"
									height="25" width="25" />
							</p:column>
							<!-- 
							<p:column>
								<h:outputText value="#{oferta.llamadaEntrante}" />
							</p:column>

							<p:column>
								<h:outputText value="#{oferta.llamadaSalientes}" />
							</p:column>

							<p:column>
								<h:outputText value="#{oferta.llamadaNoContestadas}" />
							</p:column>
							-->
							<p:columnGroup type="footer">
								<p:row>
									<p:column colspan="2" footerText="Totales"
										style="text-align: right" />
									<p:column footerText="$ #{ofertaPedidoBean.valorTotal}"
										style="text-align: right" />
									<p:column footerText="$ #{ofertaPedidoBean.valorTotalP}"
										style="text-align: right" />
									<p:column footerText="#{ofertaPedidoBean.valorPor} %"
										style="text-align: right" />
									<p:column colspan="1" footerText="" style="text-align: right" />	
									<p:column footerText="$ #{ofertaPedidoBean.valorTotalPre}"
										style="text-align: right" />
									<p:column footerText="$ #{ofertaPedidoBean.valorTotalF}"
										style="text-align: right" />
									<p:column footerText=" #{ofertaPedidoBean.valorPorV} %"
										style="text-align: right" />				
									<p:column colspan="1" footerText="" style="text-align: right" />
								</p:row>
							</p:columnGroup>

							<f:facet name="footer">
								
							</f:facet>
						</p:dataTable>
					</h:form>
				</div>
			</div>
		</div>
		</p:panel>
	</ui:define>
</ui:composition>
</html>